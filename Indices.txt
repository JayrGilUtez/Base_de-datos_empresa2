-- Índices

-- Para obtener información sobre los índices podemos consultar varios diccionarios:

-- 1) "user_indexes": Nos muestra las siguientes columnas(entre otras que no analizaremos)
    -- INDEX_NAME (NOMBRE DEL ÍNDICE)
    -- INDEX_TYPE (TIPO DEL ÍNDICE, TRABAJAREMOS CON EL STANDARD NORMAL)
    -- TABLE_NAME (NOMBRE DE LA TABLA)
    -- UNIQUENESS (SI ES ÚNICO O NO)

-- 2) "user_ind_columns": Nos muestra las siguientes columnas(entre otras que no analizaremos)
    -- INDEX_NAME (NOMBRE DEL ÍNDICE)
    -- TABLE_NAME (NOMBRE DE LA TABLA)
    -- COLUMN_NAME (NOMBRE DEL CAMPO)
    -- COLUMN_POSITION (POSICIÓN DEL CAMPO)

-- 3) "user_objects": En la columna "OBJECT_TYPE", muestra "INDEX" si es un índice

-- 4) "user_constraints": Si la restricción tiene un índice asociado, 
-- aparecer su nombre en la columna "INDEX_NAME" 

-----------------------------------------------------------------------------------------------------------

-- Consulta todas las llaves de la tabla empleado

SELECT CONSTRAINT_NAME, CONSTRAINT_TYPE, INDEX_NAME FROM USER_CONSTRAINTS WHERE TABLE_NAME = 'EMPLEADO';

--EJERCICIOS 
--CREAR UN INDICE UNICO SOBRE EL CAMPO APELLIDO1

CREATE UNIQUE INDEX I_EMPLEADO_APELLIDO1 ON EMPLEADO(APELLIDO1);

SELECT INDEX_NAME, INDEX_TYPE, UNIQUENESS
FROM USER_INDEXES
WHERE TABLE_NAME = 'EMPLEADO';

-- AGREGAMOS A LA TABLA UNA RESTRICCION UNICA SOBRE EL CAMPO APELLIDO1

ALTER TABLE EMPLEADO
ADD CONSTRAINT UQ_empleado_Apellido1
UNIQUE (Apellido1);

-- ANALICEMOS LA INFORMACIÓN QUE NOS MUESTRA EL "USER_CONSTRAINT"

SELECT CONSTRAINT_NAME, CONSTRAINT_TYPE, INDEX_NAME
FROM USER_CONSTRAINTS
WHERE TABLE_NAME = 'EMPLEADO';

-- CREA UN INDICE NO UNICO Y COMPUESTO PARA LOS CAMPOS APELLIDO1 Y NOMBRE

CREATE INDEX II_EMPLEADO_APELLIDO1NOMBRE ON EMPLEADO (APELLIDO1, NOMBRE);

-- VEAMOS TODOS LOS INDICES DE LA BASE DE DATOS ACTIVA
-- CONSULTANDO "USER_OBJECTS"
SELECT OBJECT_NAME, OBJECT_TYPE FROM USER_OBJECTS WHERE OBJECT_TYPE = 'INDEX';

SELECT INDEX_NAME, COLUMN_NAME, COLUMN_POSITION FROM USER_IND_COLUMNS WHERE TABLE_NAME = 'EMPLEADO';

INSERT INTO EMPLEADO(NOMBRE, APELLIDO1, APELLIDO2, DNI, FECHANAC, DIRECCION, SEXO, SUELDO, SUPERDNI, DNO)
VALUES('EDUARDO', 'MIRAMON', 'JUAREZ', 03, TO_DATE('12-16-1996', 'MM-DD-YYYY'), 'México', 'H', 3000, 888665555, 1);
SELECT *FROM EMPLEADO;

INSERT INTO EMPLEADO(NOMBRE, APELLIDO1, APELLIDO2, DNI, FECHANAC, DIRECCION, SEXO, SUELDO, SUPERDNI, DNO)
VALUES('PEDRO', 'MIRAMON', 'JUAREZ', 12, TO_DATE('12-16-1996', 'MM-DD-YYYY'), 'México', 'H', 3000, 888665555, 1);

ALTER TABLE EMPLEADO
DROP CONSTRAINT UQ_empleado_Apellido1;

DROP INDEX I_EMPLEADO_APELLIDO1;
DROP INDEX II_EMPLEADO_APELLIDO1NOMBRE;

--------------------------------------------------------------------------------------------------------------------------